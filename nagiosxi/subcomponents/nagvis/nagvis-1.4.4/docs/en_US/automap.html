<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
  <head>
    <title>NagVis Automap</title>
		<link rel="stylesheet" type="text/css" media="screen" href="../general/css/style.css" />
  </head>
	<body>
		<h1>NagVis Automap</h1>
		<h2> Introduction </h2>
		The NagVis Automap is introduced in NagVis 1.3. The main topic of this feature is to replace the builtin map in Nagios. The main problem of the Nagios map is that it is not scalable. In big Nagios installations the automap is not usable. This is e.g. caused by missing configuration options like selecting a defined scope of elements to display.
		
		NagVis handles the objects and defines a configuration for <a href="http://www.graphviz.org" target="_blank">Graphviz</a>. The map image and the HTML-Code for the links are generated by graphviz and passed on to NagVis.
		
		<h2> Prerequisites </h2>
		<ul>
		<li> Working NDO installation</li>
		<li> <a href="http://www.graphviz.org" target="_blank">Graphviz</a> >= 2.14 for the automap (lower versions have problems with truecolor rendering). You also need more packages like gd,libpng,freetype, … but if you get graphviz compiled/installed it should work.</li>
		<li> You have to define dependencies between hosts starting with the Nagios server. Please have a look at the <a href="http://nagios.sourceforge.net/docs/3_0/networkreachability.html">Nagios documentation</a> on how to do this</li> 
		</ul>
		
		<h2> First call </h2>
		The automap can be called like this: <code>http://&lt;nagios-server>/&lt;path-to-nagvis>/nagvis/index.php?automap=1</code>.
		
		If everything is configured properly the root host and 2 levels of child hosts should be displayed on the automap.
		
		<h2> Main configuration </h2>
		Some parameters for the automap can be set in the main configuration of NagVis. For further information see <a href="nagvis_config_format_description.html">Main Config Format Description</a>.
		
		<h2> Map configuration </h2>
		The automap can be configured by a special map configuration file named <code>__automap.cfg</code>. The map configuration file is stored in the normal map path (<code>etc/maps/</code>). This configuration file contains only a global section. All values can be defined like explained in the "global" chapter on <a href="map_config_format_description.html">Map Config Format Description</a>.
		
		The values like iconset etc. are inherited to all objects on the map.
		
		<h2> URL Parameters </h2>
		The automap can be called with several url parameters. Here is a list of all available options:
		
		<table style="width:100%">
		<tr>
		<th> parameter </th><th> default </th><th> description </th>
		</tr>
		<tr>
		<td> backend </td><td> default backend </td><td> The backend-id of the backend to fetch the objects from. For details see the [backend_*] section in the <a href="nagvis_config_format_description.html">Main Config Format Description</a> </td>
		</tr>
		<tr>
		<td> root </td><td> see <a href="#root/object/definition">root object definition</a> </td><td> This is the name of the root object. It is not essential to set the host here. There are some more ways to tell the root object. For details see the <a href="#root/object/definition">root object definition</a> chapter on this page. </td>
		</tr>
		<tr>
		<td> maxLayers </td><td> 2 </td><td> Maximum layers of child hosts to be displayed. </td>
		</tr>
		<tr>
		<td> renderMode </td><td> undirected </td><td> Set the render mode of the map. For details see <a href="#available/render/modes">available render modes</a> </td>
		</tr>
		<tr>
		<td> width </td><td> 1024 </td><td> width of the automap in pixels </td>
		</tr>
		<tr>
		<td> height </td><td> 786 </td><td> height of the automap in pixels </td>
		</tr>
		<tr>
		<td> ignoreHosts </td><td> none </td><td> comma separated list of hosts (including children) not to display </td>
		</tr>
		<tr>
		<td>filterGroup</td><td>none</td><td>Provide a hostgroup name. Only hosts in this hostgroup will be shown on the map.</td>
		</tr>
		</table>
		
		<a name=root/object/definition></a>
		<h2> Root object definition </h2>
		The approach of the automap is to start at one root object and go down the dependency-tree like defined in Nagios and show all these objects on the map.
		
		There are several ways to get the root object:
		<ul>
		<li> URL-Parameter: The root object can be set by the parameter <code>root</code>.</li>
		<li> Main configuration: The <code>defaultroot</code> option can be set in the <code>[automap]</code>-section.</li>
		<li> Auto detection: Ask the NDO for a host without parent. This only works when there is ONE host in the NDO without any parent object.</li>
		</ul>
		
		The list above is ordered by priority.
		
		<a name=available/render/modes></a>
		<h2> Available render modes </h2>
		There are several render modes available:
		
		<table>
		<tr>
		<th> Mode </th><th style="width:200px"> Example image </th>
		</tr>
		<tr>
		<td valign="top"> directed </td>
		<td align="center"><img alt="" src="../general/img/nagvis-1.3-automap-directed-1-thumb.png" /></td>
		</tr>
		<tr>
		<td valign="top"> undirected </td>
		<td align="center"><img alt="" src="../general/img/nagvis-1.3-automap_undirected-1-thumb.png" /></td>
		</tr>
		<tr>
		<td valign="top"> radial </td>
		<td> </td>
		</tr>
		<tr>
		<td valign="top"> circular </td>
		<td> </td>
		</tr>
		<tr>
		<td valign="top"> undirected2 </td>
		<td> </td>
		</tr>
	</body>
</html>
